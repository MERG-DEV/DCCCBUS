divert(-1)
define(wait_until_idle;)

define(enter_learn_mode,
       rx_data(OPC_NNLRN, $1, $2) -- NNLRN, CBUS enter learn mode
       wait_until_idle)

define(exit_learn_mode,
       rx_data(OPC_NNULN, $1, $2) -- NNULN, CBUS exit learn mode
       wait_until_idle)

define(flim_led, RB6)
define(wait_until_flim,
       wait until flim_led == '1';
       report("test_name: Yellow LED (FLiM) on");)

define(slim_led, RB7)
define(wait_until_slim,
       wait until slim_led == '1';
       report("test_name: Green LED (SLiM) on");)

define(configure_can,
       if CANCON.REQOP2 != '1' then
         report("test_name: Waiting to configure CAN");
         wait until CANCON.REQOP2 == '1';
       end if;
       CANSTAT.OPMODE2 <= '1';
       report("test_name: Configuring CAN");
       wait until CANCON.REQOP2 == '0';
       CANSTAT.OPMODE2 <= '0';
       report("test_name: CAN configured");)

define(setup_button, RA2)
define(set_setup_off, setup_button <= '1';)
define(set_setup_on, setup_button <= '0';)

define(dcc_input, INT0)
define(set_dcc_off, dcc_input <= '0';)
define(set_dcc_on, dcc_input <= '1';)

divert(0)dnl
