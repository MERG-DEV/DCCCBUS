divert(-1)

define(wait_until_idle, {--})

-- 16MHz clock = 4 instruction cycles per microsecond
define(u_sec, {eval($1 * 4)} ic)

define(flim_led, RB6)
define(slim_led, RB7)

define(confirm_not_flim,
       if flim_led == '1' then
         log(Yellow LED (FLiM) on)
         test_state := fail;
       end if;)

define(confirm_flim,
       if flim_led != '1' then
         log(Yellow LED (FLiM) off)
         test_state := fail;
       end if;)

define(confirm_not_slim,
       if slim_led == '1' then
         log(Green LED (SLiM) on)
         test_state := fail;
       end if;)

define(confirm_slim,
       if slim_led != '1' then
         log(Green LED (SLiM) off)
         test_state := fail;
       end if;)

define(wait_until_flim,
       wait until flim_led == '1';
       log(Yellow LED (FLiM) on)
       confirm_not_slim)

define(wait_until_slim,
       wait until slim_led == '1';
       log(Green LED (SLiM) on)
       confirm_not_flim)

define(setup_button, RA5)
define(set_setup_off, setup_button <= '1';)
define(set_setup_on, setup_button <= '0';)

define(dcc_input, INT0)
define(set_dcc_off, dcc_input <= '0';)
define(set_dcc_on, dcc_input <= '1';)

define(paired_outputs_input, RC7)
define(set_paired_outputs_off, paired_outputs_input <= '1';)
define(set_paired_outputs_on, paired_outputs_input <= '0';)

define(rcn213_linear_addressing_input, RC5)
define(set_rcn213_linear_addressing_off, rcn213_linear_addressing_input <= '1';)
define(set_rcn213_linear_addressing_on, rcn213_linear_addressing_input <= '0';)

define(cancmd_addressing_input, RC6)
define(set_cancmd_addressing_off, cancmd_addressing_input <= '1';)
define(set_cancmd_addressing_on, cancmd_addressing_input <= '0';)

define(wait_for_high_priority_interrupt,
       wait until INTCON.GIE_GIEH == '0';
       wait until INTCON.GIE_GIEH == '1';)

define(wait_for_low_priority_interrupt,
       wait until INTCON.PEIE_GIEL == '0';
       wait until INTCON.PEIE_GIEL == '1';)

divert(0)dnl
